var Zr=Object.defineProperty;var Mr=(t,i)=>{for(var r in i)Zr(t,r,{get:i[r],enumerable:!0,configurable:!0,set:(a)=>i[r]=()=>a})};var Ir={Stringify:1,BeforeStream:2,Stream:3},I=(t,i)=>{let r=new String(t);return r.isEscaped=!0,r.callbacks=i,r},Qr=/[&<>'"]/,ti=async(t,i)=>{let r="";i||=[];let a=await Promise.all(t);for(let v=a.length-1;;v--){if(r+=a[v],v--,v<0)break;let F=a[v];if(typeof F==="object")i.push(...F.callbacks||[]);let u=F.isEscaped;if(F=await(typeof F==="object"?F.toString():F),typeof F==="object")i.push(...F.callbacks||[]);if(F.isEscaped??u)r+=F;else{let s=[r];K(F,s),r=s[0]}}return I(r,i)},K=(t,i)=>{let r=t.search(Qr);if(r===-1){i[0]+=t;return}let a,v,F=0;for(v=r;v<t.length;v++){switch(t.charCodeAt(v)){case 34:a="&quot;";break;case 39:a="&#39;";break;case 38:a="&amp;";break;case 60:a="&lt;";break;case 62:a="&gt;";break;default:continue}i[0]+=t.substring(F,v)+a,F=v+1}i[0]+=t.substring(F,v)},ii=(t)=>{let i=t.callbacks;if(!i?.length)return t;let r=[t],a={};return i.forEach((v)=>v({phase:Ir.Stringify,buffer:r,context:a})),r[0]};var p=Symbol("RENDERER"),D=Symbol("ERROR_HANDLER"),z=Symbol("STASH"),mt=Symbol("INTERNAL"),ft=Symbol("MEMO"),V=Symbol("PERMALINK");var ri=(t)=>{return t[mt]=!0,t};var ai=(t)=>({value:i,children:r})=>{if(!r)return;let a={children:[{tag:ri(()=>{t.push(i)}),props:{}}]};if(Array.isArray(r))a.children.push(...r.flat());else a.children.push(r);a.children.push({tag:ri(()=>{t.pop()}),props:{}});let v={tag:"",props:a,type:""};return v[D]=(F)=>{throw t.pop(),F},v},nt=(t)=>{let i=[t],r=ai(i);return r.values=i,r.Provider=r,X.push(r),r};var X=[],Zi=(t)=>{let i=[t],r=(a)=>{i.push(a.value);let v;try{v=a.children?(Array.isArray(a.children)?new ni("",{},a.children):a.children).toString():""}catch(F){throw i.pop(),F}if(v instanceof Promise)return v.finally(()=>i.pop()).then((F)=>I(F,F.callbacks));else return i.pop(),I(v)};return r.values=i,r.Provider=r,r[p]=ai(i),X.push(r),r},Q=(t)=>{return t.values.at(-1)};var x={title:[],script:["src"],style:["data-href"],link:["href"],meta:["name","httpEquiv","charset","itemProp"]},vt={},j="data-precedence";var st={};Mr(st,{title:()=>Wr,style:()=>qr,script:()=>kr,meta:()=>Cr,link:()=>Ur,input:()=>Xr,form:()=>Jr,button:()=>br});var S=(t)=>Array.isArray(t)?t:[t];var Mi=new WeakMap,Ii=(t,i,r,a)=>({buffer:v,context:F})=>{if(!v)return;let u=Mi.get(F)||{};Mi.set(F,u);let s=u[t]||=[],P=!1,c=x[t];if(c.length>0)t:for(let[,y]of s)for(let o of c)if((y?.[o]??null)===r?.[o]){P=!0;break t}if(P)v[0]=v[0].replaceAll(i,"");else if(c.length>0)s.push([i,r,a]);else s.unshift([i,r,a]);if(v[0].indexOf("</head>")!==-1){let y;if(a===void 0)y=s.map(([o])=>o);else{let o=[];y=s.map(([w,,T])=>{let B=o.indexOf(T);if(B===-1)o.push(T),B=o.length-1;return[w,B]}).sort((w,T)=>w[1]-T[1]).map(([w])=>w)}y.forEach((o)=>{v[0]=v[0].replaceAll(o,"")}),v[0]=v[0].replace(/(?=<\/head>)/,y.join(""))}},Ft=(t,i,r)=>I(new W(t,r,S(i??[])).toString()),ut=(t,i,r,a)=>{if("itemProp"in r)return Ft(t,i,r);let{precedence:v,blocking:F,...u}=r;if(v=a?v??"":void 0,a)u[j]=v;let s=new W(t,u,S(i||[])).toString();if(s instanceof Promise)return s.then((P)=>I(s,[...P.callbacks||[],Ii(t,P,u,v)]));else return I(s,[Ii(t,s,u,v)])},Wr=({children:t,...i})=>{let r=At();if(r){let a=Q(r);if(a==="svg"||a==="head")return new W("title",i,S(t??[]))}return ut("title",t,i,!1)},kr=({children:t,...i})=>{let r=At();if(["src","async"].some((a)=>!i[a])||r&&Q(r)==="head")return Ft("script",t,i);return ut("script",t,i,!1)},qr=({children:t,...i})=>{if(!["href","precedence"].every((r)=>(r in i)))return Ft("style",t,i);return i["data-href"]=i.href,delete i.href,ut("style",t,i,!0)},Ur=({children:t,...i})=>{if(["onLoad","onError"].some((r)=>(r in i))||i.rel==="stylesheet"&&(!("precedence"in i)||("disabled"in i)))return Ft("link",t,i);return ut("link",t,i,"precedence"in i)},Cr=({children:t,...i})=>{let r=At();if(r&&Q(r)==="head")return Ft("meta",t,i);return ut("meta",t,i,!1)},Qi=(t,{children:i,...r})=>new W(t,r,S(i??[])),Jr=(t)=>{if(typeof t.action==="function")t.action=V in t.action?t.action[V]:void 0;return Qi("form",t)},Wi=(t,i)=>{if(typeof i.formAction==="function")i.formAction=V in i.formAction?i.formAction[V]:void 0;return Qi(t,i)},Xr=(t)=>Wi("input",t),br=(t)=>Wi("button",t);var Or=new Map([["className","class"],["htmlFor","for"],["crossOrigin","crossorigin"],["httpEquiv","http-equiv"],["itemProp","itemprop"],["fetchPriority","fetchpriority"],["noModule","nomodule"],["formAction","formaction"]]),d=(t)=>Or.get(t)||t,$t=(t,i)=>{for(let[r,a]of Object.entries(t)){let v=r[0]==="-"||!/[A-Z]/.test(r)?r:r.replace(/[A-Z]/g,(F)=>`-${F.toLowerCase()}`);i(v,a==null?null:typeof a==="number"?!v.match(/^(?:a|border-im|column(?:-c|s)|flex(?:$|-[^b])|grid-(?:ar|[^a])|font-w|li|or|sca|st|ta|wido|z)|ty$/)?`${a}px`:`${a}`:a)}};var ct=void 0,At=()=>ct,Kr=(t)=>/[A-Z]/.test(t)&&t.match(/^(?:al|basel|clip(?:Path|Rule)$|co|do|fill|fl|fo|gl|let|lig|i|marker[EMS]|o|pai|pointe|sh|st[or]|text[^L]|tr|u|ve|w)/)?t.replace(/([A-Z])/g,"-$1").toLowerCase():t,Rr=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],hr=["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","download","formnovalidate","hidden","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected"],Fi=(t,i)=>{for(let r=0,a=t.length;r<a;r++){let v=t[r];if(typeof v==="string")K(v,i);else if(typeof v==="boolean"||v===null||v===void 0)continue;else if(v instanceof W)v.toStringToBuffer(i);else if(typeof v==="number"||v.isEscaped)i[0]+=v;else if(v instanceof Promise)i.unshift("",v);else Fi(v,i)}},W=class{tag;props;key;children;isEscaped=!0;localContexts;constructor(t,i,r){this.tag=t,this.props=i,this.children=r}get type(){return this.tag}get ref(){return this.props.ref||null}toString(){let t=[""];this.localContexts?.forEach(([i,r])=>{i.values.push(r)});try{this.toStringToBuffer(t)}finally{this.localContexts?.forEach(([i])=>{i.values.pop()})}return t.length===1?"callbacks"in t?ii(I(t[0],t.callbacks)).toString():t[0]:ti(t,t.callbacks)}toStringToBuffer(t){let i=this.tag,r=this.props,{children:a}=this;t[0]+=`<${i}`;let v=ct&&Q(ct)==="svg"?(F)=>Kr(d(F)):(F)=>d(F);for(let[F,u]of Object.entries(r))if(F=v(F),F==="children");else if(F==="style"&&typeof u==="object"){let s="";$t(u,(P,c)=>{if(c!=null)s+=`${s?";":""}${P}:${c}`}),t[0]+=' style="',K(s,t),t[0]+='"'}else if(typeof u==="string")t[0]+=` ${F}="`,K(u,t),t[0]+='"';else if(u===null||u===void 0);else if(typeof u==="number"||u.isEscaped)t[0]+=` ${F}="${u}"`;else if(typeof u==="boolean"&&hr.includes(F)){if(u)t[0]+=` ${F}=""`}else if(F==="dangerouslySetInnerHTML"){if(a.length>0)throw Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");a=[I(u.__html)]}else if(u instanceof Promise)t[0]+=` ${F}="`,t.unshift('"',u);else if(typeof u==="function"){if(!F.startsWith("on")&&F!=="ref")throw Error(`Invalid prop '${F}' of type 'function' supplied to '${i}'.`)}else t[0]+=` ${F}="`,K(u.toString(),t),t[0]+='"';if(Rr.includes(i)&&a.length===0){t[0]+="/>";return}t[0]+=">",Fi(a,t),t[0]+=`</${i}>`}},vi=class extends W{toStringToBuffer(t){let{children:i}=this,r={...this.props};if(i.length)r.children=i.length===1?i[0]:i;let a=this.tag.call(null,r);if(typeof a==="boolean"||a==null)return;else if(a instanceof Promise)if(X.length===0)t.unshift("",a);else{let v=X.map((F)=>[F,F.values.at(-1)]);t.unshift("",a.then((F)=>{if(F instanceof W)F.localContexts=v;return F}))}else if(a instanceof W)a.toStringToBuffer(t);else if(typeof a==="number"||a.isEscaped){if(t[0]+=a,a.callbacks)t.callbacks||=[],t.callbacks.push(...a.callbacks)}else K(a,t)}},ni=class extends W{toStringToBuffer(t){Fi(this.children,t)}};var ki=!1,Bt=(t,i,r)=>{if(!ki){for(let a in vt)st[a][p]=vt[a];ki=!0}if(typeof t==="function")return new vi(t,i,r);else if(st[t])return new vi(st[t],i,r);else if(t==="svg"||t==="head")return ct||=Zi(""),new W(t,i,[new vi(ct,{value:t},r)]);else return new W(t,i,r)};var q=({children:t})=>{return new ni("",{children:t},Array.isArray(t)?t:t?[t]:[])};var Pt="_hp",Sr={Change:"Input",DoubleClick:"DblClick"},Nr={svg:"2000/svg",math:"1998/Math/MathML"},R=[],si=new WeakMap,e=void 0,Oi=()=>e,b=(t)=>("t"in t),ui={onClick:["click",!1]},qi=(t)=>{if(!t.startsWith("on"))return;if(ui[t])return ui[t];let i=t.match(/^on([A-Z][a-zA-Z]+?(?:PointerCapture)?)(Capture)?$/);if(i){let[,r,a]=i;return ui[t]=[(Sr[r]||r).toLowerCase(),!!a]}return},Ui=(t,i)=>e&&t instanceof SVGElement&&/[A-Z]/.test(i)&&((i in t.style)||i.match(/^(?:o|pai|str|u|ve)/))?i.replace(/([A-Z])/g,"-$1").toLowerCase():i,Er=(t,i,r)=>{i||={};for(let a in i){let v=i[a];if(a!=="children"&&(!r||r[a]!==v)){a=d(a);let F=qi(a);if(F){if(r?.[a]!==v){if(r)t.removeEventListener(F[0],r[a],F[1]);if(v!=null){if(typeof v!=="function")throw Error(`Event handler for "${a}" is not a function`);t.addEventListener(F[0],v,F[1])}}}else if(a==="dangerouslySetInnerHTML"&&v)t.innerHTML=v.__html;else if(a==="ref"){let u;if(typeof v==="function")u=v(t)||(()=>v(null));else if(v&&"current"in v)v.current=t,u=()=>v.current=null;si.set(t,u)}else if(a==="style"){let u=t.style;if(typeof v==="string")u.cssText=v;else if(u.cssText="",v!=null)$t(v,u.setProperty.bind(u))}else{if(a==="value"){let s=t.nodeName;if(s==="INPUT"||s==="TEXTAREA"||s==="SELECT"){if(t.value=v===null||v===void 0||v===!1?null:v,s==="TEXTAREA"){t.textContent=v;continue}else if(s==="SELECT"){if(t.selectedIndex===-1)t.selectedIndex=0;continue}}}else if(a==="checked"&&t.nodeName==="INPUT"||a==="selected"&&t.nodeName==="OPTION")t[a]=v;let u=Ui(t,a);if(v===null||v===void 0||v===!1)t.removeAttribute(u);else if(v===!0)t.setAttribute(u,"");else if(typeof v==="string"||typeof v==="number")t.setAttribute(u,v);else t.setAttribute(u,v.toString())}}}if(r)for(let a in r){let v=r[a];if(a!=="children"&&!(a in i)){a=d(a);let F=qi(a);if(F)t.removeEventListener(F[0],v,F[1]);else if(a==="ref")si.get(t)?.();else t.removeAttribute(Ui(t,a))}}},pr=(t,i)=>{i[z][0]=0,R.push([t,i]);let r=i.tag[p]||i.tag,a=r.defaultProps?{...r.defaultProps,...i.props}:i.props;try{return[r.call(null,a)]}finally{R.pop()}},Ki=(t,i,r,a,v)=>{if(t.vR?.length)a.push(...t.vR),delete t.vR;if(typeof t.tag==="function")t[z][1][Ht]?.forEach((F)=>v.push(F));t.vC.forEach((F)=>{if(b(F))r.push(F);else if(typeof F.tag==="function"||F.tag===""){F.c=i;let u=r.length;if(Ki(F,i,r,a,v),F.s){for(let s=u;s<r.length;s++)r[s].s=!0;F.s=!1}}else if(r.push(F),F.vR?.length)a.push(...F.vR),delete F.vR})},Dr=(t)=>{for(;;t=t.tag===Pt||!t.vC||!t.pP?t.nN:t.vC[0]){if(!t)return null;if(t.tag!==Pt&&t.e)return t.e}},Ri=(t)=>{if(!b(t)){if(t[z]?.[1][Ht]?.forEach((i)=>i[2]?.()),si.get(t.e)?.(),t.p===2)t.vC?.forEach((i)=>i.p=2);t.vC?.forEach(Ri)}if(!t.p)t.e?.remove(),delete t.e;if(typeof t.tag==="function")ot.delete(t),Tt.delete(t),delete t[z][3],t.a=!0},ci=(t,i,r)=>{t.c=i,hi(t,i,r)},Ci=(t,i)=>{if(!i)return;for(let r=0,a=t.length;r<a;r++)if(t[r]===i)return r;return},Ji=Symbol(),hi=(t,i,r)=>{let a=[],v=[],F=[];Ki(t,i,a,v,F),v.forEach(Ri);let u=r?void 0:i.childNodes,s,P=null;if(r)s=-1;else if(!u.length)s=0;else{let c=Ci(u,Dr(t.nN));if(c!==void 0)P=u[c],s=c;else s=Ci(u,a.find((y)=>y.tag!==Pt&&y.e)?.e)??-1;if(s===-1)r=!0}for(let c=0,y=a.length;c<y;c++,s++){let o=a[c],w;if(o.s&&o.e)w=o.e,o.s=!1;else{let T=r||!o.e;if(b(o)){if(o.e&&o.d)o.e.textContent=o.t;o.d=!1,w=o.e||=document.createTextNode(o.t)}else w=o.e||=o.n?document.createElementNS(o.n,o.tag):document.createElement(o.tag),Er(w,o.props,o.pP),hi(o,w,T)}if(o.tag===Pt)s--;else if(r){if(!w.parentNode)i.appendChild(w)}else if(u[s]!==w&&u[s-1]!==w)if(u[s+1]===w)i.appendChild(u[s]);else i.insertBefore(w,P||u[s]||null)}if(t.pP)delete t.pP;if(F.length){let c=[],y=[];if(F.forEach(([,o,,w,T])=>{if(o)c.push(o);if(w)y.push(w);T?.()}),c.forEach((o)=>o()),y.length)requestAnimationFrame(()=>{y.forEach((o)=>o())})}},Vr=(t,i)=>!!(t&&t.length===i.length&&t.every((r,a)=>r[1]===i[a][1])),Tt=new WeakMap,Lt=(t,i,r)=>{let a=!r&&i.pC;if(r)i.pC||=i.vC;let v;try{if(r||=typeof i.tag=="function"?pr(t,i):S(i.props.children),r[0]?.tag===""&&r[0][D])v=r[0][D],t[5].push([t,v,i]);let F=a?[...i.pC]:i.vC?[...i.vC]:void 0,u=[],s;for(let P=0;P<r.length;P++){if(Array.isArray(r[P]))r.splice(P,1,...r[P].flat());let c=Si(r[P]);if(c){if(typeof c.tag==="function"&&!c.tag[mt]){if(X.length>0)c[z][2]=X.map((o)=>[o,o.values.at(-1)]);if(t[5]?.length)c[z][3]=t[5].at(-1)}let y;if(F&&F.length){let o=F.findIndex(b(c)?(w)=>b(w):c.key!==void 0?(w)=>w.key===c.key&&w.tag===c.tag:(w)=>w.tag===c.tag);if(o!==-1)y=F[o],F.splice(o,1)}if(y)if(b(c)){if(y.t!==c.t)y.t=c.t,y.d=!0;c=y}else{let o=y.pP=y.props;if(y.props=c.props,y.f||=c.f||i.f,typeof c.tag==="function"){let w=y[z][2];if(y[z][2]=c[z][2]||[],y[z][3]=c[z][3],!y.f&&((y.o||y)===c.o||y.tag[ft]?.(o,y.props))&&Vr(w,y[z][2]))y.s=!0}c=y}else if(!b(c)&&e){let o=Q(e);if(o)c.n=o}if(!b(c)&&!c.s)Lt(t,c),delete c.f;if(u.push(c),s&&!s.s&&!c.s)for(let o=s;o&&!b(o);o=o.vC?.at(-1))o.nN=c;s=c}}if(i.vR=a?[...i.vC,...F||[]]:F||[],i.vC=u,a)delete i.pC}catch(F){if(i.f=!0,F===Ji)if(v)return;else throw F;let[u,s,P]=i[z]?.[3]||[];if(s){let c=()=>yt([0,!1,t[2]],P),y=Tt.get(P)||[];y.push(c),Tt.set(P,y);let o=s(F,()=>{let w=Tt.get(P);if(w){let T=w.indexOf(c);if(T!==-1)return w.splice(T,1),c()}});if(o){if(t[0]===1)t[1]=!0;else if(Lt(t,P,[o]),(s.length===1||t!==u)&&P.c){ci(P,P.c,!1);return}throw Ji}}throw F}finally{if(v)t[5].pop()}},Si=(t)=>{if(t===void 0||t===null||typeof t==="boolean")return;else if(typeof t==="string"||typeof t==="number")return{t:t.toString(),d:!0};else{if("vR"in t)t={tag:t.tag,props:t.props,key:t.key,f:t.f,type:t.tag,ref:t.props.ref,o:t.o||t};if(typeof t.tag==="function")t[z]=[0,[]];else{let i=Nr[t.tag];if(i)e||=nt(""),t.props.children=[{tag:e,props:{value:t.n=`http://www.w3.org/${i}`,children:t.props.children}}]}return t}},Ni=(t,i,r)=>{if(t.c===i)t.c=r,t.vC.forEach((a)=>Ni(a,i,r))},Xi=(t,i)=>{i[z][2]?.forEach(([r,a])=>{r.values.push(a)});try{Lt(t,i,void 0)}catch{return}if(i.a){delete i.a;return}if(i[z][2]?.forEach(([r])=>{r.values.pop()}),t[0]!==1||!t[1])ci(i,i.c,!1)},ot=new WeakMap,bi=[],yt=async(t,i)=>{t[5]||=[];let r=ot.get(i);if(r)r[0](void 0);let a,v=new Promise((F)=>a=F);if(ot.set(i,[a,()=>{if(t[2])t[2](t,i,(F)=>{Xi(F,i)}).then(()=>a(i));else Xi(t,i),a(i)}]),bi.length)bi.at(-1).add(i);else{await Promise.resolve();let F=ot.get(i);if(F)ot.delete(i),F[1]()}return v},xr=(t,i)=>{let r=[];r[5]=[],r[4]=!0,Lt(r,t,void 0),r[4]=!1;let a=document.createDocumentFragment();ci(t,a,!0),Ni(t,a,i),i.replaceChildren(a)},oi=(t,i)=>{xr(Si({tag:"",props:{children:t}}),i)};var Pi=(t,i,r)=>({tag:Pt,props:{children:t},key:r,e:i,p:1});var jr=0,Ht=1,dr=2,er=3,t0=4,yi=new WeakMap,wi=(t,i)=>!t||!i||t.length!==i.length||i.some((r,a)=>r!==t[a]);var i0=void 0;var Ei=[];var f=(t)=>{let i=()=>typeof t==="function"?t():t,r=R.at(-1);if(!r)return[i(),()=>{}];let[,a]=r,v=a[z][1][jr]||=[],F=a[z][0]++;return v[F]||=[i(),(u)=>{let s=i0,P=v[F];if(typeof u==="function")u=u(P[0]);if(!Object.is(u,P[0]))if(P[0]=u,Ei.length){let[c,y]=Ei.at(-1);Promise.all([c===3?a:yt([c,!1,s],a),y]).then(([o])=>{if(!o||!(c===2||c===3))return;let w=o.vC;requestAnimationFrame(()=>{setTimeout(()=>{if(w!==o.vC)return;yt([c===3?1:0,!1,s],o)})})})}else yt([0,!1,s],a)}]};var r0=(t,i,r)=>{let a=R.at(-1);if(!a)return;let[,v]=a,F=v[z][1][Ht]||=[],u=v[z][0]++,[s,,P]=F[u]||=[];if(wi(s,r)){if(P)P();let c=()=>{y[t]=void 0,y[2]=i()},y=[r,void 0,void 0,void 0,void 0];y[t]=c,F[u]=y}},L=(t,i)=>r0(3,t,i);var g=(t,i)=>{let r=R.at(-1);if(!r)return t;let[,a]=r,v=a[z][1][dr]||=[],F=a[z][0]++,u=v[F];if(wi(u?.[1],i))v[F]=[t,i];else t=v[F][0];return t},Y=(t)=>{let i=R.at(-1);if(!i)return{current:t};let[,r]=i,a=r[z][1][t0]||=[],v=r[z][0]++;return a[v]||={current:t}},li=(t)=>{let i=yi.get(t);if(i){if(i.length===2)throw i[1];return i[0]}throw t.then((r)=>yi.set(t,[r]),(r)=>yi.set(t,[void 0,r])),t},gi=(t,i)=>{let r=R.at(-1);if(!r)return t();let[,a]=r,v=a[z][1][er]||=[],F=a[z][0]++,u=v[F];if(wi(u?.[1],i))v[F]=[t(),i];return v[F][0]};var Di=nt({pending:!1,data:null,method:null,action:null}),pi=new Set,Vi=(t)=>{pi.add(t),t.finally(()=>pi.delete(t))};var mi=(t,i)=>{return gi(()=>(r)=>{let a;if(t){if(typeof t==="function")a=t(r)||(()=>{t(null)});else if(t&&"current"in t)t.current=r,a=()=>{t.current=null}}let v=i(r);return()=>{v?.(),a?.()}},[t])},xi=Object.create(null),ji=Object.create(null),wt=(t,i,r,a,v)=>{if(i?.itemProp)return{tag:t,props:i,type:t,ref:i.ref};let F=document.head,{onLoad:u,onError:s,precedence:P,blocking:c,...y}=i,o=null,w=!1,T=x[t],B=void 0;if(T.length>0){let m=F.querySelectorAll(t);t:for(let l of m)for(let A of x[t])if(l.getAttribute(A)===i[A]){o=l;break t}if(!o){let l=T.reduce((A,_)=>i[_]===void 0?A:`${A}-${_}-${i[_]}`,t);w=!ji[l],o=ji[l]||=(()=>{let A=document.createElement(t);for(let _ of T){if(i[_]!==void 0)A.setAttribute(_,i[_]);if(i.rel)A.setAttribute("rel",i.rel)}return A})()}}else B=F.querySelectorAll(t);if(P=a?P??"":void 0,a)y[j]=P;let G=g((m)=>{if(T.length>0){let l=!1;for(let A of F.querySelectorAll(t)){if(l&&A.getAttribute(j)!==P){F.insertBefore(m,A);return}if(A.getAttribute(j)===P)l=!0}F.appendChild(m)}else if(B){let l=!1;for(let A of B)if(A===m){l=!0;break}if(!l)F.insertBefore(m,F.contains(B[0])?B[0]:F.querySelector(t));B=void 0}},[P]),$=mi(i.ref,(m)=>{let l=T[0];if(r===2)m.innerHTML="";if(w||B)G(m);if(!s&&!u)return;let A=xi[m.getAttribute(l)]||=new Promise((_,M)=>{m.addEventListener("load",_),m.addEventListener("error",M)});if(u)A=A.then(u);if(s)A=A.catch(s);A.catch(()=>{})});if(v&&c==="render"){let m=x[t][0];if(i[m]){let l=i[m],A=xi[l]||=new Promise((_,M)=>{G(o),o.addEventListener("load",_),o.addEventListener("error",M)});li(A)}}let H={tag:t,type:t,props:{...y,ref:$},ref:$};if(H.p=r,o)H.e=o;return Pi(H,F)},a0=(t)=>{let i=Oi();if((i&&Q(i))?.endsWith("svg"))return{tag:"title",props:t,type:"title",ref:t.ref};return wt("title",t,void 0,!1,!1)},n0=(t)=>{if(!t||["src","async"].some((i)=>!t[i]))return{tag:"script",props:t,type:"script",ref:t.ref};return wt("script",t,1,!1,!0)},v0=(t)=>{if(!t||!["href","precedence"].every((i)=>(i in t)))return{tag:"style",props:t,type:"style",ref:t.ref};return t["data-href"]=t.href,delete t.href,wt("style",t,2,!0,!0)},F0=(t)=>{if(!t||["onLoad","onError"].some((i)=>(i in t))||t.rel==="stylesheet"&&(!("precedence"in t)||("disabled"in t)))return{tag:"link",props:t,type:"link",ref:t.ref};return wt("link",t,1,"precedence"in t,!0)},u0=(t)=>{return wt("meta",t,void 0,!1,!1)},di=Symbol(),s0=(t)=>{let{action:i,...r}=t;if(typeof i!=="function")r.action=i;let[a,v]=f([null,!1]),F=g(async(c)=>{let y=c.isTrusted?i:c.detail[di];if(typeof y!=="function")return;c.preventDefault();let o=new FormData(c.target);v([o,!0]);let w=y(o);if(w instanceof Promise)Vi(w),await w;v([null,!0])},[]),u=mi(t.ref,(c)=>{return c.addEventListener("submit",F),()=>{c.removeEventListener("submit",F)}}),[s,P]=a;return a[1]=!1,{tag:Di,props:{value:{pending:s!==null,data:s,method:s?"post":null,action:s?i:null},children:{tag:"form",props:{...r,ref:u},type:"form",ref:u}},f:P}},ei=(t,{formAction:i,...r})=>{if(typeof i==="function"){let a=g((v)=>{v.preventDefault(),v.currentTarget.form.dispatchEvent(new CustomEvent("submit",{detail:{[di]:i}}))},[]);r.ref=mi(r.ref,(v)=>{return v.addEventListener("click",a),()=>{v.removeEventListener("click",a)}})}return{tag:t,props:r,type:t,ref:r.ref}},c0=(t)=>ei("input",t),o0=(t)=>ei("button",t);Object.assign(vt,{title:a0,script:n0,style:v0,link:F0,meta:u0,form:s0,input:c0,button:o0});var tt="#222244,#2D2B55,#B362FF,#FFFFFF,#2D2B55,#A599E9,#3AD900,#FAD000,#3B3768,#7E74A8",fi=[{name:"meet-ai Default",schema:"#194234,#9c2e33,#E7C12e,#194234,#9c2e33,#FFFFFF,#ee6030,#9C2E33,#9c2e33,#FFFFFF"},{name:"One Dark Pro",schema:"#282C34,#2C313A,#528BFF,#FFFFFF,#2C313A,#ABB2BF,#98C379,#E06C75,#3E4451,#5C6370"},{name:"Dracula",schema:"#282A36,#343746,#BD93F9,#FFFFFF,#343746,#F8F8F2,#50FA7B,#FF79C6,#44475A,#6272A4"},{name:"GitHub Dark",schema:"#0D1117,#161B22,#1F6FEB,#FFFFFF,#161B22,#C9D1D9,#3FB950,#F85149,#21262D,#8B949E"},{name:"Nord",schema:"#2E3440,#3B4252,#88C0D0,#ECEFF4,#3B4252,#D8DEE9,#A3BE8C,#BF616A,#434C5E,#4C566A"},{name:"Monokai",schema:"#272822,#3E3D32,#F92672,#FFFFFF,#3E3D32,#F8F8F2,#A6E22E,#F92672,#49483E,#75715E"},{name:"Solarized Dark",schema:"#002B36,#073642,#2AA198,#FFFFFF,#073642,#839496,#859900,#DC322F,#073642,#586E75"},{name:"Tokyo Night",schema:"#1A1B26,#24283B,#7AA2F7,#FFFFFF,#24283B,#A9B1D6,#73DACA,#F7768E,#2F3549,#565F89"},{name:"Catppuccin Mocha",schema:"#1E1E2E,#313244,#89B4FA,#FFFFFF,#313244,#CDD6F4,#A6E3A1,#F38BA8,#45475A,#6C7086"},{name:"Gruvbox Dark",schema:"#282828,#3C3836,#FABD2F,#282828,#3C3836,#EBDBB2,#B8BB26,#FB4934,#504945,#928374"},{name:"Ayu Dark",schema:"#0B0E14,#131721,#E6B450,#0B0E14,#131721,#BFBDB6,#AAD94C,#F07178,#11151C,#565B66"},{name:"Ayu Mirage",schema:"#1F2430,#272D38,#FFCC66,#1F2430,#272D38,#CCCAC2,#D5FF80,#F28779,#171B24,#5C6166"},{name:"Ayu Light",schema:"#FAFAFA,#F0F0F0,#FF9940,#FFFFFF,#F0F0F0,#575F66,#86B300,#F07171,#E8E8E8,#ABB0B6"},{name:"Night Owl",schema:"#011627,#0B2942,#7E57C2,#FFFFFF,#0B2942,#D6DEEB,#ADDB67,#EF5350,#122D42,#5F7E97"},{name:"One Light",schema:"#FAFAFA,#EAEAEB,#4078F2,#FFFFFF,#EAEAEB,#383A42,#50A14F,#E45649,#D4D4D4,#A0A1A7"},{name:"Shades of Purple",schema:"#222244,#2D2B55,#B362FF,#FFFFFF,#2D2B55,#A599E9,#3AD900,#FAD000,#3B3768,#7E74A8"}],Ai=["Column BG","Menu Hover","Active Item","Active Text","Hover Item","Text Color","Presence","Badge","Divider","Alt Text"],U={apiKey:"meet-ai-key",handle:"meet-ai-handle",colorSchema:"meet-ai-color-schema"};function $i(){return localStorage.getItem(U.apiKey)}function rr(t){localStorage.setItem(U.apiKey,t)}function y0(){localStorage.removeItem(U.apiKey)}function it(){let t=$i(),i={"Content-Type":"application/json"};if(t)i.Authorization="Bearer "+t;return i}async function ar(){let t=await fetch("/api/rooms",{headers:it()});if(t.status===401)return y0(),location.href="/key",[];return t.json()}async function nr(t){let i=await fetch(`/api/rooms/${t}/messages`,{headers:it()});if(!i.ok)return[];return i.json()}async function vr(t,i){let r=await fetch(`/api/rooms/${t}/messages?since_seq=${i}`,{headers:it()});if(!r.ok)return[];return r.json()}async function Fr(t){let i=await fetch(`/api/rooms/${t}/logs`,{headers:it()});if(!i.ok)return[];return(await i.json()).map((a)=>({...a,type:"log"}))}async function lt(t,i,r){let a=await fetch(`/api/rooms/${t}/messages`,{method:"POST",headers:it(),body:JSON.stringify({sender:i,content:r})});if(!a.ok)throw Error("HTTP "+a.status)}async function zt(t){let i=await fetch("/api/auth/claim/"+encodeURIComponent(t));if(!i.ok)throw Error("Link expired or invalid");return i.json()}async function ur(){let t=await fetch("/api/auth/share",{method:"POST",headers:it()});if(!t.ok)throw Error("Failed to create share link");return t.json()}function n(t,i,r){let a;if(!i||!("children"in i))a=Bt(t,i,[]);else{let v=i.children;a=Array.isArray(v)?Bt(t,i,v):Bt(t,i,[v])}return a.key=r,a}function Gt({onLogin:t}){let[i,r]=f(""),[a,v]=f(!1),F=Y(null);L(()=>{F.current?.focus()},[]);let u=g(async()=>{let P=F.current?.value.trim();if(!P)return;r(""),v(!0);try{if(P.startsWith("http")&&P.includes("/auth/")){let c=P.split("/auth/").pop()?.split("?")[0]?.split("#")[0];if(!c){r("Invalid link"),v(!1);return}let y=await zt(c);t(y.api_key)}else if(P.startsWith("mai_"))t(P);else r("Invalid link or key"),v(!1)}catch(c){r(c.message||"Connection error. Try again."),v(!1)}},[t]),s=g((P)=>{if(P.key==="Enter")P.preventDefault(),u()},[u]);return n("div",{class:"main",style:"height:100dvh",children:n("div",{class:"login-prompt",children:[n("h2",{children:"Welcome to meet-ai"},void 0,!1,void 0,this),n("p",{children:"Paste a login link from another device or enter your API key to continue."},void 0,!1,void 0,this),n("div",{class:"login-prompt-form",children:[n("input",{ref:F,type:"text",placeholder:"Paste login link or API key",autocomplete:"off",spellcheck:!1,onKeyDown:s},void 0,!1,void 0,this),n("button",{onClick:u,disabled:a,children:a?"...":"Go"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"login-error",children:i},void 0,!1,void 0,this),n("div",{class:"login-or",children:["or ",n("a",{href:"/",children:"get an API key"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)}function _t({token:t,onLogin:i}){let[r,a]=f(""),[v,F]=f(!1),u=window.navigator.standalone===!0||window.matchMedia("(display-mode: standalone)").matches,s=/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,P=/Android/.test(navigator.userAgent),c=g(async()=>{F(!0),a("");try{let w=await zt(t);i(w.api_key)}catch(w){a(w.message||"Connection error. Try again."),F(!1)}},[t,i]),y=v?"Connecting...":u?"Connect":"Connect in browser",o=null;if(!u)if(s)o=n("div",{class:"install-steps",children:[n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"1"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Tap the ",n("strong",{children:"Share"},void 0,!1,void 0,this)," button at the bottom of Safari"]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"2"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Scroll down and tap ",n("strong",{children:"Add to Home Screen"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"3"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Tap ",n("strong",{children:"Add"},void 0,!1,void 0,this)," in the top right corner"]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"4"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Open the app from your Home Screen and tap ",n("strong",{children:"Connect"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this);else if(P)o=n("div",{class:"install-steps",children:[n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"1"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Tap the ",n("strong",{children:"menu"},void 0,!1,void 0,this)," button ⋮ in Chrome"]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"2"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Tap ",n("strong",{children:"Install app"},void 0,!1,void 0,this)," or ",n("strong",{children:"Add to Home screen"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"3"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Open the app from your Home Screen and tap ",n("strong",{children:"Connect"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this);else o=n("div",{class:"install-steps",children:[n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"1"},void 0,!1,void 0,this),n("div",{class:"step-text",children:"Install the app using your browser's install option"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"install-step",children:[n("div",{class:"step-num",children:"2"},void 0,!1,void 0,this),n("div",{class:"step-text",children:["Open the app and tap ",n("strong",{children:"Connect"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this);return n("div",{class:"main",style:"height:100dvh",children:n("div",{class:"token-screen",children:[n("h2",{children:u?"Connect to chat":"Install meet-ai"},void 0,!1,void 0,this),n("p",{children:u?"Tap the button below to activate your session.":"Add meet-ai to your Home Screen for the best experience."},void 0,!1,void 0,this),u?n("div",{class:"token-card",children:[n("button",{type:"button",class:"connect-btn",onClick:c,disabled:v,children:y},void 0,!1,void 0,this),n("div",{class:"connect-error",children:r},void 0,!1,void 0,this)]},void 0,!0,void 0,this):n(q,{children:[o&&n("div",{class:"token-card",children:o},void 0,!1,void 0,this),n("div",{class:"separator"},void 0,!1,void 0,this),n("p",{class:"alt-text",children:"Or connect directly in this browser:"},void 0,!1,void 0,this),n("div",{class:"token-card",children:[n("button",{type:"button",class:"connect-btn",onClick:c,disabled:v,children:y},void 0,!1,void 0,this),n("div",{class:"connect-error",children:r},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)}function Yt({onSettingsClick:t,onCloseClick:i}){return n("div",{class:"sidebar-header",children:[n("span",{children:"meet-ai"},void 0,!1,void 0,this),n("div",{class:"sidebar-header-actions",children:[n("button",{title:"Color Settings",onClick:t,children:n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"},void 0,!1,void 0,this),n("circle",{cx:"12",cy:"12",r:"3"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),n("button",{class:"sidebar-close-btn",title:"Close sidebar",onClick:i,children:n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("line",{x1:"18",y1:"6",x2:"6",y2:"18"},void 0,!1,void 0,this),n("line",{x1:"6",y1:"6",x2:"18",y2:"18"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)}function Zt({rooms:t,currentRoomId:i,onSelectRoom:r}){return n(q,{children:[n("div",{class:"sidebar-section-label",children:"Channels"},void 0,!1,void 0,this),n("div",{class:"room-list",children:t.map((a)=>n("div",{class:`room-item${a.id===i?" active":""}`,onClick:()=>r(a),children:[n("span",{class:"room-hash",children:"#"},void 0,!1,void 0,this)," ",a.name]},a.id,!0,void 0,this))},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function Mt(){let[t,i]=f(null),[r,a]=f(!1),[v,F]=f(!1),[u,s]=f(!1);L(()=>{if(window.navigator.standalone===!0||window.matchMedia("(display-mode: standalone)").matches)return;if(/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream){a(!0),s(!0);return}let o=(T)=>{T.preventDefault(),i(T),s(!0)};window.addEventListener("beforeinstallprompt",o);let w=()=>{s(!1),i(null)};return window.addEventListener("appinstalled",w),()=>{window.removeEventListener("beforeinstallprompt",o),window.removeEventListener("appinstalled",w)}},[]);let P=g(async()=>{if(r){F(!0);return}if(t){await t.prompt();let{outcome:c}=await t.userChoice;if(c==="accepted")s(!1);i(null)}},[r,t]);if(!u)return null;return n(q,{children:[n("button",{class:"install-btn",title:"Install app",onClick:P,children:[n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},void 0,!1,void 0,this),n("polyline",{points:"7 10 12 15 17 10"},void 0,!1,void 0,this),n("line",{x1:"12",y1:"15",x2:"12",y2:"3"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),"Install"]},void 0,!0,void 0,this),v&&n("div",{class:"ios-install-overlay",onClick:()=>F(!1),children:n("div",{class:"ios-install-panel",onClick:(c)=>c.stopPropagation(),children:[n("h3",{children:"Install meet-ai"},void 0,!1,void 0,this),n("div",{class:"ios-install-steps",children:[n("div",{class:"ios-install-step",children:[n("span",{class:"ios-step-num",children:"1"},void 0,!1,void 0,this),n("span",{class:"ios-step-text",children:["Tap the ",n("strong",{children:"Share"},void 0,!1,void 0,this)," button",n("svg",{class:"ios-share-icon",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"},void 0,!1,void 0,this),n("polyline",{points:"16 6 12 2 8 6"},void 0,!1,void 0,this),n("line",{x1:"12",y1:"2",x2:"12",y2:"15"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),"in the toolbar"]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"ios-install-step",children:[n("span",{class:"ios-step-num",children:"2"},void 0,!1,void 0,this),n("span",{class:"ios-step-text",children:["Scroll down and tap ",n("strong",{children:"Add to Home Screen"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"ios-install-step",children:[n("span",{class:"ios-step-num",children:"3"},void 0,!1,void 0,this),n("span",{class:"ios-step-text",children:["Tap ",n("strong",{children:"Add"},void 0,!1,void 0,this)," in the top right"]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this),n("button",{class:"ios-install-close",onClick:()=>F(!1),children:"Got it"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function It({userName:t,onNameChange:i}){let[r,a]=f(!1),[v,F]=f(t),u=g(()=>{F(t),a(!0)},[t]),s=g(()=>{let c=v.trim();if(c)i(c);a(!1)},[v,i]),P=g((c)=>{if(c.key==="Enter")c.preventDefault(),s();if(c.key==="Escape")F(t),a(!1)},[s,t]);return n("div",{class:"sidebar-footer",children:[n("span",{class:"user-presence",style:"width:8px;height:8px;border-radius:50%;background:var(--c-presence);flex-shrink:0;"},void 0,!1,void 0,this),r?n("input",{type:"text",value:v,maxLength:30,style:"background:var(--c-hover-item);color:inherit;border:1px solid var(--c-sidebar-border);border-radius:4px;padding:2px 6px;font-size:16px;width:130px;outline:none;font-weight:600;",onInput:(c)=>F(c.target.value),onKeyDown:P,onBlur:s,ref:(c)=>c?.focus()},void 0,!1,void 0,this):n("span",{class:"user-handle",title:"Click to change your name",onClick:u,children:t},void 0,!1,void 0,this),n("div",{class:"sidebar-footer-actions",children:[n(Mt,{},void 0,!1,void 0,this),n("button",{title:"API Key settings",onClick:()=>{location.href="/key"},children:n("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:n("path",{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"},void 0,!1,void 0,this)},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)}function Qt({rooms:t,currentRoomId:i,userName:r,isOpen:a,onSelectRoom:v,onNameChange:F,onSettingsClick:u,onClose:s}){return n("aside",{class:`sidebar${a?" open":""}`,children:[n(Yt,{onSettingsClick:u,onCloseClick:s},void 0,!1,void 0,this),n(Zt,{rooms:t,currentRoomId:i,onSelectRoom:v},void 0,!1,void 0,this),n(It,{userName:r,onNameChange:F},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function Wt({onClick:t}){return n("div",{class:"sidebar-backdrop",onClick:t,style:"display:block"},void 0,!1,void 0,this)}function kt({roomName:t,showInvite:i,showTeamToggle:r,onMobileToggle:a,onTeamToggle:v,onInviteClick:F}){return n("div",{class:"main-header",children:[n("div",{class:"main-header-left",children:[n("button",{class:"mobile-toggle",onClick:a,children:"☰"},void 0,!1,void 0,this),n("span",{class:"channel-hash",children:"#"},void 0,!1,void 0,this),n("span",{class:"channel-name",children:t},void 0,!1,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"main-header-right",children:[i&&n("button",{class:"invite-btn",title:"Open on phone",onClick:F,children:n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("rect",{x:"5",y:"2",width:"14",height:"20",rx:"2",ry:"2"},void 0,!1,void 0,this),n("line",{x1:"12",y1:"18",x2:"12.01",y2:"18"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),r&&n("button",{class:"team-toggle",title:"Team members",onClick:v,children:n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},void 0,!1,void 0,this),n("circle",{cx:"9",cy:"7",r:"4"},void 0,!1,void 0,this),n("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"},void 0,!1,void 0,this),n("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)}function qt({message:t="Select or create a channel to start chatting",showBackLink:i}){return n("div",{class:"empty-state",children:[n("div",{class:"icon",children:"#"},void 0,!1,void 0,this),n("div",{children:t},void 0,!1,void 0,this),i&&n("div",{style:"font-size:13px;margin-top:4px",children:n("a",{href:"/chat",style:"color:var(--c-primary)",children:"Back to channels"},void 0,!1,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function Bi(t){let i=t.split(",").map((r)=>r.trim());while(i.length<10)i.push("#888888");return i}function Ut(t){if(t=t.replace("#",""),t.length===3)t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2];let i=parseInt(t,16);return[i>>16&255,i>>8&255,i&255]}function h(t){let[i,r,a]=Ut(t).map((v)=>{return v=v/255,v<=0.04045?v/12.92:Math.pow((v+0.055)/1.055,2.4)});return 0.2126*i+0.7152*r+0.0722*a}function k(t,i){let r=h(t),a=h(i),v=Math.max(r,a),F=Math.min(r,a);return(v+0.05)/(F+0.05)}function sr(t,i,r){if(k(t,i)>=r)return t;let a=k("#FFFFFF",i),v=k("#000000",i);return a>=v?"#FFFFFF":"#000000"}function w0(t){if(h(t)>=0.5)return"#FFFFFF";let[r,a,v]=Ut(t);return"#"+[r,a,v].map((F)=>Math.max(0,Math.round(F*0.78+2)).toString(16).padStart(2,"0")).join("")}function l0(t,i){if(h(t)>=0.5)return"#1D1C1D";return i||"#ABB2BF"}function g0(t,i){if(h(t)>=0.5)return"#E0E0E0";return i||"#3e4451"}function O(t){let i=Bi(t),r=document.documentElement,a=h(i[0])<0.5,v=sr(i[5],i[0],3),F=sr(i[3],i[2],3);r.style.setProperty("--c-sidebar-bg",i[0]),r.style.setProperty("--c-sidebar-text",v),r.style.setProperty("--c-active-item",i[2]),r.style.setProperty("--c-active-item-text",F),r.style.setProperty("--c-hover-item",i[4]||i[1]),r.style.setProperty("--c-presence",i[6]),r.style.setProperty("--c-primary",i[6]),r.style.setProperty("--c-sidebar-border",i[8]||(a?"rgba(255,255,255,0.1)":"rgba(0,0,0,0.1)"));let u=w0(i[0]),s=l0(u,v),P=g0(i[0],i[8]);r.style.setProperty("--c-header-bg",u),r.style.setProperty("--c-header-text",s),r.style.setProperty("--c-chat-bg",u),r.style.setProperty("--c-msg-text",s),r.style.setProperty("--c-border",P),document.body.style.background=u,r.style.setProperty("--c-input-bg",a?i[0]:u);let c=k("#FFFFFF",i[6]),y=k("#000000",i[6]);r.style.setProperty("--c-primary-text",c>=y?"#FFFFFF":"#000000")}function Ct(t){let i=0;for(let a=0;a<t.length;a++)i=t.charCodeAt(a)+((i<<5)-i);return`hsl(${(i%360+360)%360}, 60%, 45%)`}function cr(t){let i=0;for(let a=0;a<t.length;a++)i=t.charCodeAt(a)+((i<<5)-i);return`hsl(${(i%360+360)%360}, 50%, 35%)`}var Ti=(()=>{let t=document.createElement("div");return t.style.display="none",document.body.appendChild(t),t})();function Li(t){Ti.style.color="",Ti.style.color=t;let r=getComputedStyle(Ti).color.match(/(\d+)/g);if(!r||r.length<3)return t;return"#"+r.slice(0,3).map((a)=>parseInt(a).toString(16).padStart(2,"0")).join("")}function N(t){let i=Li(t),r=getComputedStyle(document.documentElement).getPropertyValue("--c-chat-bg").trim()||"#FFFFFF";if(k(i,r)>=3)return t;let a=h(r),[v,F,u]=Ut(i);if(a<0.5){for(let s=1.5;s<=3;s+=0.3){let P="#"+[v,F,u].map((c)=>Math.min(255,Math.round(c*s)).toString(16).padStart(2,"0")).join("");if(k(P,r)>=3)return P}return"#CCCCCC"}else{for(let s=0.5;s>=0.2;s-=0.1){let P="#"+[v,F,u].map((c)=>Math.round(c*s).toString(16).padStart(2,"0")).join("");if(k(P,r)>=3)return P}return"#555555"}}function or(t){return DOMPurify.sanitize(marked.parse(t,{breaks:!0}))}function Pr(t){if(window.highlightAllCode)window.highlightAllCode(t)}function m0(t){let i=document.createElement("div");return i.textContent=t,i.innerHTML}function f0(t){if(!t)return"";try{let i=new Date(t);if(isNaN(i.getTime()))return"";return i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}catch{return""}}function Jt({sender:t,content:i,color:r,timestamp:a,tempId:v,status:F="sent",onRetry:u}){let s=Y(null),P=r?N(r):Ct(t),c=r?N(r):cr(t),y=t.slice(0,2).toUpperCase(),o=Li(c),w=k("#FFFFFF",o)>=k("#000000",o)?"#FFFFFF":"#000000",T=F==="pending"?" msg-pending":F==="failed"?" msg-failed":"",B=F==="pending"?"sending":F==="failed"?"failed":f0(a);return L(()=>{if(s.current)s.current.innerHTML=or(i),Pr(s.current)},[i]),n("div",{class:`msg${T}`,"data-temp-id":v,"data-content":v?i:void 0,children:[n("div",{class:"msg-avatar",style:`background:${c};color:${w}`,children:m0(y)},void 0,!1,void 0,this),n("div",{class:"msg-body",children:[n("div",{class:"msg-header",children:[n("span",{class:"msg-sender",style:`color:${P}`,children:t},void 0,!1,void 0,this),n("span",{class:"msg-time",children:B},void 0,!1,void 0,this),F==="failed"&&u&&n("span",{class:"msg-retry",onClick:u,style:"display:inline",children:"retry"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),n("div",{class:"msg-content",ref:s},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)}function Hi(t){if(!t)return"";try{let i=new Date(t);if(isNaN(i.getTime()))return"";return i.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return""}}function A0(t){let i=[...new Set(t.map((a)=>a.sender))],r=t.length;if(i.length===1)return`${r} log ${r===1?"entry":"entries"} from ${i[0]}`;return`${r} log entries from ${i.length} agents`}function Xt({logs:t}){let[i,r]=f(!1);if(t.length===0)return null;let a=Hi(t[0].created_at),v=t.length>1?Hi(t[t.length-1].created_at):null,F=v&&v!==a?`${a} - ${v}`:a;return n("div",{class:"log-group",children:[n("div",{class:"log-group-header",onClick:()=>r(!i),children:[n("span",{class:"log-group-toggle",children:i?"▾":"▸"},void 0,!1,void 0,this),n("span",{class:"log-group-summary",children:A0(t)},void 0,!1,void 0,this),n("span",{class:"log-group-time",children:F},void 0,!1,void 0,this)]},void 0,!0,void 0,this),i&&n("div",{class:"log-group-entries",children:t.map((u,s)=>{let P=u.color?N(u.color):Ct(u.sender);return n("div",{class:"log-entry",children:[n("span",{class:"log-entry-time",children:Hi(u.created_at)},void 0,!1,void 0,this),n("span",{class:"log-entry-sender",style:`color:${P}`,children:[u.sender,":"]},void 0,!0,void 0,this),n("span",{class:"log-entry-content",children:u.content},void 0,!1,void 0,this)]},`${u.sender}-${u.created_at}-${s}`,!0,void 0,this)})},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function bt({count:t,onClick:i}){if(t===0)return null;return n("div",{class:"new-messages-pill",onClick:i,children:[t," new message",t===1?"":"s"," ↓"]},void 0,!0,void 0,this)}function yr(t){let i=Y(!0),[r,a]=f(!0);L(()=>{let u=t.current;if(!u)return;let s=()=>{let P=u.scrollHeight-u.scrollTop-u.clientHeight<80;i.current=P,a(P)};return u.addEventListener("scroll",s,{passive:!0}),()=>u.removeEventListener("scroll",s)},[t]);let v=g(()=>i.current??!0,[]),F=g(()=>{let u=t.current;if(!u)return;u.scrollTop=u.scrollHeight,i.current=!0,a(!0)},[t]);return{isAtBottom:v,atBottom:r,scrollToBottom:F}}function $0(t){let i=new Map,r=[];for(let u=0;u<t.length;u++){let s=t[u];if(s.type==="log"&&s.message_id){let P=i.get(s.message_id)||[];P.push(s),i.set(s.message_id,P)}else r.push({index:u,msg:s})}let a=[],v=[];function F(){if(v.length>0)a.push({kind:"log-group",logs:v}),v=[]}for(let{index:u,msg:s}of r)if(s.type==="log")v.push(s);else{F(),a.push({kind:"message",msg:s,index:u});let P=s.id?i.get(s.id):void 0;if(P&&P.length>0)a.push({kind:"log-group",logs:P})}return F(),a}function Ot({messages:t,unreadCount:i,onScrollToBottom:r,onRetry:a}){let v=Y(null),{isAtBottom:F,atBottom:u,scrollToBottom:s}=yr(v),P=Y(0);L(()=>{if(t.length>(P.current??0)&&F())s();P.current=t.length},[t.length]),L(()=>{if(u&&i>0)r()},[u,i,r]),L(()=>{s()},[]);let c=$0(t);return n("div",{class:"messages",ref:v,children:[c.map((y,o)=>{if(y.kind==="log-group"){let T=y.logs[0];return n(Xt,{logs:y.logs},`log-group-${T.sender}-${T.created_at}-${o}`,!1,void 0,this)}let w=y.msg;return n(Jt,{sender:w.sender,content:w.content,color:w.color,timestamp:w.created_at,tempId:w.tempId,status:w.status,onRetry:w.tempId&&a?()=>a(w.tempId):void 0},w.tempId||`${w.sender}-${w.created_at}-${y.index}`,!1,void 0,this)}),n(bt,{count:i,onClick:()=>{s(),r()}},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function B0(t,i){let{selectionStart:r,selectionEnd:a,value:v}=t,F=v.slice(r,a),u;switch(i){case"bold":u=`**${F||"text"}**`;break;case"italic":u=`*${F||"text"}*`;break;case"code":u=F.includes(`
`)?`\`\`\`
${F||"code"}
\`\`\``:`\`${F||"code"}\``;break;case"link":u=`[${F||"text"}](url)`;break;default:return}t.value=v.slice(0,r)+u+v.slice(a),t.focus();let s=r+u.length;t.setSelectionRange(s,s)}var C=(t)=>t.preventDefault();function Kt({textareaRef:t,onSend:i}){let r=(a)=>{if(t.current)B0(t.current,a)};return n("div",{class:"chat-input-toolbar",children:[n("button",{class:"fmt-btn",title:"Bold",onMouseDown:C,onTouchStart:C,onTouchEnd:()=>r("bold"),onClick:()=>r("bold"),children:n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:n("path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8"},void 0,!1,void 0,this)},void 0,!1,void 0,this)},void 0,!1,void 0,this),n("button",{class:"fmt-btn",title:"Italic",onMouseDown:C,onTouchStart:C,onTouchEnd:()=>r("italic"),onClick:()=>r("italic"),children:n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("line",{x1:"19",x2:"10",y1:"4",y2:"4"},void 0,!1,void 0,this),n("line",{x1:"14",x2:"5",y1:"20",y2:"20"},void 0,!1,void 0,this),n("line",{x1:"15",x2:"9",y1:"4",y2:"20"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),n("button",{class:"fmt-btn",title:"Code",onMouseDown:C,onTouchStart:C,onTouchEnd:()=>r("code"),onClick:()=>r("code"),children:n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("polyline",{points:"16 18 22 12 16 6"},void 0,!1,void 0,this),n("polyline",{points:"8 6 2 12 8 18"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),n("button",{class:"fmt-btn",title:"Link",onMouseDown:C,onTouchStart:C,onTouchEnd:()=>r("link"),onClick:()=>r("link"),children:n("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"},void 0,!1,void 0,this),n("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this),n("div",{class:"toolbar-spacer"},void 0,!1,void 0,this),n("button",{class:"send-btn",title:"Send",onMouseDown:C,onTouchStart:C,onTouchEnd:i,onClick:i,children:n("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[n("path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"},void 0,!1,void 0,this),n("path",{d:"m21.854 2.147-10.94 10.939"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function wr(t){let i=g(()=>{let a=t.current;if(!a)return;a.style.height="auto",a.style.height=Math.min(a.scrollHeight,200)+"px"},[t]),r=g(()=>{let a=t.current;if(!a)return;a.value="",a.style.height="auto"},[t]);return{resize:i,reset:r}}function Rt({roomName:t,onSend:i}){let r=Y(null),{resize:a,reset:v}=wr(r),F=g(()=>{let s=r.current,P=s?.value.trim();if(!P||!s)return;i(P),v(),s.focus(),requestAnimationFrame(()=>s.focus())},[i,v]),u=g((s)=>{if(s.key==="Enter"&&!s.shiftKey&&!matchMedia("(pointer: coarse)").matches)s.preventDefault(),F()},[F]);return n("div",{class:"chat-input-area",children:n("div",{class:"chat-input-box",children:[n("textarea",{ref:r,placeholder:`Message #${t}`,rows:1,onInput:a,onKeyDown:u},void 0,!1,void 0,this),n(Kt,{textareaRef:r,onSend:F},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)}var zi=1000,T0=30000;function lr(t,i,r,a){let v=Y(null),F=Y(r);F.current=r;let u=Y(a?.onTeamInfo);u.current=a?.onTeamInfo;let s=Y(0),P=Y(zi),[c,y]=f(!0);return L(()=>{if(!t||!i)return;async function o(){if(!t||s.current===0)return;try{let B=await vr(t,s.current);for(let G of B){if(G.seq&&G.seq>s.current)s.current=G.seq;F.current?.(G)}}catch{}}function w(){if(v.current)v.current.close();let B=location.protocol==="https:"?"wss:":"ws:",G=`?token=${encodeURIComponent(i)}`,$=new WebSocket(`${B}//${location.host}/api/rooms/${t}/ws${G}`);$.onopen=()=>{y(!0),P.current=zi,o()},$.onmessage=(H)=>{try{let m=JSON.parse(H.data);if(m.type==="team_info"){u.current?.(m);return}let l=m;if(!l.sender||!l.content)return;if(l.seq&&l.seq>s.current)s.current=l.seq;F.current?.(l)}catch{}},$.onerror=()=>console.error("WebSocket error"),$.onclose=()=>{y(!1);let H=P.current;P.current=Math.min(H*2,T0),setTimeout(()=>{if(v.current===$)w()},H)},v.current=$}w();let T=()=>{if(document.visibilityState==="visible")if(!v.current||v.current.readyState!==WebSocket.OPEN)P.current=zi,w();else o()};return document.addEventListener("visibilitychange",T),()=>{if(document.removeEventListener("visibilitychange",T),v.current){let B=v.current;v.current=null,B.close()}}},[t,i]),{wsRef:v,connected:c}}function ht(){return new Promise((t,i)=>{let r=indexedDB.open("meet-ai-queue",1);r.onupgradeneeded=()=>{let a=r.result;if(!a.objectStoreNames.contains("outbox"))a.createObjectStore("outbox",{keyPath:"tempId"})},r.onsuccess=()=>t(r.result),r.onerror=()=>i(r.error)})}async function L0(t){let r=(await ht()).transaction("outbox","readwrite");if(r.objectStore("outbox").put(t),await new Promise((a,v)=>{r.oncomplete=()=>a(),r.onerror=()=>v(r.error)}),"serviceWorker"in navigator&&"SyncManager"in window)await(await navigator.serviceWorker.ready).sync.register("send-messages")}async function H0(t){try{(await ht()).transaction("outbox","readwrite").objectStore("outbox").delete(t)}catch{}}async function z0(t){let a=(await ht()).transaction("outbox","readonly").objectStore("outbox").getAll();return(await new Promise((F,u)=>{a.onsuccess=()=>F(a.result),a.onerror=()=>u(a.error)})).filter((F)=>F.roomId===t)}async function G0(){let r=(await ht()).transaction("outbox","readonly").objectStore("outbox").getAll();return new Promise((a,v)=>{r.onsuccess=()=>a(r.result),r.onerror=()=>v(r.error)})}function gr(){let t=g(L0,[]),i=g(H0,[]),r=g(z0,[]),a=g(G0,[]);return{queue:t,remove:i,getForRoom:r,getAll:a}}async function mr(){if(!("Notification"in window))return"denied";if(Notification.permission!=="default")return Notification.permission;return Notification.requestPermission()}function fr(t,i){if(!("Notification"in window))return;if(Notification.permission!=="granted")return;if(document.visibilityState!=="hidden")return;if(t.type==="log")return;if(t.sender===i)return;let r=new Notification(t.sender,{body:t.content.slice(0,100),tag:t.id??t.message_id??void 0,icon:"/favicon.ico"});r.onclick=()=>{window.focus(),r.close()}}function St({room:t,apiKey:i,userName:r,onTeamInfo:a}){let[v,F]=f([]),[u,s]=f(0),{queue:P,remove:c,getForRoom:y}=gr();L(()=>{let $=!1;async function H(){let[m,l]=await Promise.all([nr(t.id),Fr(t.id)]);if($)return;let A=[...m,...l].sort((_,M)=>new Date(_.created_at).getTime()-new Date(M.created_at).getTime());F(A.map((_)=>({..._,status:"sent"})));try{let _=await y(t.id);if($||_.length===0)return;if(F((M)=>[...M,..._.map((J)=>({sender:J.sender,content:J.content,created_at:new Date(J.timestamp).toISOString(),tempId:J.tempId,status:"failed"}))]),navigator.onLine)for(let M of _)try{if(await lt(M.roomId,M.sender,M.content),await c(M.tempId),!$)F((J)=>J.map((gt)=>gt.tempId===M.tempId?{...gt,status:"sent"}:gt))}catch{}}catch{}}return H(),()=>{$=!0}},[t.id]),L(()=>{mr()},[]);let o=g(($)=>{if(fr($,r),$.sender===r)F((H)=>{let m=H.findIndex((l)=>l.tempId&&l.content===$.content);if(m!==-1){let l=[...H];return l.splice(m,1),[...l,{...$,status:"sent"}]}return[...H,{...$,status:"sent"}]});else F((H)=>[...H,{...$,status:"sent"}]),s((H)=>H+1)},[r]),w=g(($)=>{a?.($)},[a]),{connected:T}=lr(t.id,i,o,{onTeamInfo:w});L(()=>{let $=async()=>{try{let H=await y(t.id);for(let m of H){F((l)=>l.map((A)=>A.tempId===m.tempId?{...A,status:"pending"}:A));try{await lt(m.roomId,m.sender,m.content),await c(m.tempId),F((l)=>l.map((A)=>A.tempId===m.tempId?{...A,status:"sent"}:A))}catch{F((l)=>l.map((A)=>A.tempId===m.tempId?{...A,status:"failed"}:A))}}}catch{}};return window.addEventListener("online",$),()=>window.removeEventListener("online",$)},[t.id]);let B=g(async($)=>{let H="pending-"+Date.now()+"-"+Math.random().toString(36).slice(2,6);F((m)=>[...m,{sender:r,content:$,created_at:new Date().toISOString(),tempId:H,status:"pending"}]);try{await lt(t.id,r,$),F((m)=>m.map((l)=>l.tempId===H?{...l,status:"sent"}:l))}catch{await P({tempId:H,roomId:t.id,sender:r,content:$,apiKey:i,timestamp:Date.now()}),F((m)=>m.map((l)=>l.tempId===H?{...l,status:"failed"}:l))}},[t.id,r,i]),G=g(async($)=>{let H=v.find((m)=>m.tempId===$);if(!H)return;F((m)=>m.map((l)=>l.tempId===$?{...l,status:"pending"}:l));try{await lt(t.id,r,H.content),F((m)=>m.map((l)=>l.tempId===$?{...l,status:"sent"}:l)),await c($)}catch{F((m)=>m.map((l)=>l.tempId===$?{...l,status:"failed"}:l))}},[t.id,r,v]);return n(q,{children:[!T&&n("div",{class:"reconnecting-bar",children:"Reconnecting..."},void 0,!1,void 0,this),n(Ot,{messages:v,unreadCount:u,onScrollToBottom:()=>s(0),onRetry:G},void 0,!1,void 0,this),n(Rt,{roomName:t.name,onSend:B},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function Nt({currentRoom:t,apiKey:i,userName:r,showInvite:a,showTeamToggle:v,onMobileToggle:F,onTeamToggle:u,onInviteClick:s,onTeamInfo:P}){let c=t?.name??"Select a channel";return n("div",{class:"main",children:[n(kt,{roomName:c,showInvite:a&&!!t,showTeamToggle:v,onMobileToggle:F,onTeamToggle:u,onInviteClick:s},void 0,!1,void 0,this),t?n(St,{room:t,apiKey:i,userName:r,onTeamInfo:P},t.id,!1,void 0,this):n(qt,{},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function Ar({member:t,inactive:i}){return n("div",{class:`team-member${i?" team-member--inactive":""}`,children:[n("span",{class:"team-member-dot",style:{background:i?"#555":N(t.color)}},void 0,!1,void 0,this),n("span",{class:"team-member-name",children:t.name},void 0,!1,void 0,this),n("span",{class:"team-member-model",children:t.model},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function Et({teamInfo:t,isOpen:i,onClose:r}){let a=t.members.filter((F)=>F.status==="active"),v=t.members.filter((F)=>F.status==="inactive");return n("div",{class:`team-sidebar${i?" open":""}`,children:[n("div",{class:"team-sidebar-header",children:[n("span",{children:t.team_name},void 0,!1,void 0,this),n("span",{class:"team-sidebar-count",children:[a.length,"/",t.members.length]},void 0,!0,void 0,this),n("button",{class:"team-sidebar-close-btn",onClick:r,children:"×"},void 0,!1,void 0,this)]},void 0,!0,void 0,this),a.length>0&&n("div",{class:"team-section",children:[n("div",{class:"team-section-label",children:"Active"},void 0,!1,void 0,this),a.map((F)=>n(Ar,{member:F},F.name,!1,void 0,this))]},void 0,!0,void 0,this),v.length>0&&n("div",{class:"team-section",children:[n("div",{class:"team-section-label",children:"Inactive"},void 0,!1,void 0,this),v.map((F)=>n(Ar,{member:F,inactive:!0},F.name,!1,void 0,this))]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)}function pt({schema:t}){let i=Bi(t);return n("div",{class:"color-preview",children:i.map((r,a)=>n("div",{class:"color-swatch",style:`background:${r}`,title:Ai[a],children:Ai[a]},a,!1,void 0,this))},void 0,!1,void 0,this)}function Dt({currentSchema:t,onSave:i,onClose:r}){let[a,v]=f(t),[F,u]=f(()=>{let B=fi.find((G)=>G.schema===t);return B?B.schema:""}),s=t,P=g((B)=>{let G=B.target.value;v(G),u(""),O(G.trim())},[]),c=g((B)=>{let G=B.target.value;if(u(G),G)v(G),O(G)},[]),y=g(()=>{i(a.trim())},[a,i]),o=g(()=>{O(s),r()},[s,r]),w=g(()=>{v(tt),u(tt),O(tt)},[]),T=g((B)=>{if(B.target.classList.contains("settings-overlay"))O(s),r()},[s,r]);return n("div",{class:"settings-overlay",onClick:T,children:n("div",{class:"settings-panel",children:[n("h2",{children:"Color Schema"},void 0,!1,void 0,this),n("label",{children:"Theme Presets"},void 0,!1,void 0,this),n("select",{value:F,onChange:c,children:[n("option",{value:"",children:"Custom"},void 0,!1,void 0,this),fi.map((B)=>n("option",{value:B.schema,children:B.name},B.name,!1,void 0,this))]},void 0,!0,void 0,this),n("label",{children:"Schema string (10 comma-separated hex colors)"},void 0,!1,void 0,this),n("input",{type:"text",value:a,onInput:P},void 0,!1,void 0,this),n(pt,{schema:a},void 0,!1,void 0,this),n("div",{class:"btn-row",children:[n("button",{class:"btn-reset",onClick:w,children:"Reset"},void 0,!1,void 0,this),n("button",{class:"btn-cancel",onClick:o,children:"Cancel"},void 0,!1,void 0,this),n("button",{class:"btn-save",onClick:y,children:"Save"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)}function Vt({onClose:t,onToast:i}){let[r,a]=f(null),[v,F]=f(null),[u,s]=f(!1);L(()=>{let y=!1;async function o(){try{let w=await ur();if(y)return;a(w.url)}catch(w){if(!y)F(w.message||"Failed to create share link")}}return o(),()=>{y=!0}},[]),L(()=>{if(!r)return;let y=document.getElementById("qr-container");if(!y)return;try{let o=qrcode(0,"M");o.addData(r),o.make(),y.innerHTML=o.createImgTag(5,8)}catch{}},[r]);let P=g(async()=>{if(!r)return;try{await navigator.clipboard.writeText(r),s(!0),setTimeout(()=>s(!1),2000)}catch{let y=document.getElementById("qr-url");if(y){let o=document.createRange();o.selectNodeContents(y),window.getSelection()?.removeAllRanges(),window.getSelection()?.addRange(o)}}},[r]),c=g((y)=>{if(y.target.classList.contains("qr-overlay"))t()},[t]);return n("div",{class:"qr-overlay",onClick:c,children:n("div",{class:"qr-panel",children:[n("h2",{children:"Login on another device"},void 0,!1,void 0,this),n("p",{class:"qr-subtitle",children:"Scan with your phone camera to sign in"},void 0,!1,void 0,this),n("div",{class:"qr-container",id:"qr-container",children:[!r&&!v&&n("div",{style:"width:200px;height:200px;display:flex;align-items:center;justify-content:center;margin:0 auto",children:n("div",{style:"width:32px;height:32px;border:3px solid var(--c-border);border-top-color:var(--c-primary);border-radius:50%;animation:spin 0.8s linear infinite"},void 0,!1,void 0,this)},void 0,!1,void 0,this),v&&n("p",{style:"color:#F85149",children:v},void 0,!1,void 0,this)]},void 0,!0,void 0,this),r&&n("div",{class:"qr-url",id:"qr-url",onClick:P,title:"Click to copy",children:r},void 0,!1,void 0,this),n("div",{class:"qr-copied",children:u?"Copied to clipboard!":""},void 0,!1,void 0,this),n("div",{class:"qr-expires",children:"Expires in 5 minutes"},void 0,!1,void 0,this),n("button",{class:"btn-close",onClick:t,children:"Close"},void 0,!1,void 0,this)]},void 0,!0,void 0,this)},void 0,!1,void 0,this)}function xt({text:t,onDone:i}){return L(()=>{let r=setTimeout(i,2100);return()=>clearTimeout(r)},[i]),n("div",{class:"toast",children:t},void 0,!1,void 0,this)}function $r(t,i){let r=Y(null),a=Y(i);a.current=i,L(()=>{if(!t)return;function v(){let F=location.protocol==="https:"?"wss:":"ws:",u=`?token=${encodeURIComponent(t)}`,s=new WebSocket(`${F}//${location.host}/api/lobby/ws${u}`);s.onmessage=(P)=>{try{let c=JSON.parse(P.data);if(c.type==="room_created")a.current?.(c.id,c.name)}catch{}},s.onclose=()=>{setTimeout(()=>{if(r.current===s)v()},3000)},r.current=s}return v(),()=>{if(r.current){let F=r.current;r.current=null,F.close()}}},[t])}function jt(){let t=location.pathname.match(/^\/chat\/([a-f0-9-]+)$/i);return t?t[1]:null}function Br(t,i){L(()=>{let v=()=>{let F=jt();i(F)};return window.addEventListener("popstate",v),()=>window.removeEventListener("popstate",v)},[t,i]);let r=g((v)=>{history.pushState({roomId:v},"","/chat/"+v)},[]),a=g((v)=>{history.replaceState(null,"",v)},[]);return{pushRoom:r,replaceUrl:a}}function dt({apiKey:t,userName:i,colorSchema:r,onNameChange:a,onSchemaChange:v}){let[F,u]=f([]),[s,P]=f(null),[c,y]=f(!1),[o,w]=f(!1),[T,B]=f(!1),[G,$]=f(null),[H,m]=f(null),[l,A]=f(!1),_=window.navigator.standalone===!0||window.matchMedia("(display-mode: standalone)").matches;L(()=>{let Z=!1;async function at(){let E=await ar();if(Z)return;u(E);let _i=jt();if(_i){let Yi=E.find((Yr)=>Yr.id===_i);if(Yi)P(Yi)}}return at(),()=>{Z=!0}},[]);let M=g((Z,at)=>{u((E)=>[...E,{id:Z,name:at}])},[]);$r(t,M);let{pushRoom:J,replaceUrl:gt}=Br(F,g((Z)=>{if(Z){let at=F.find((E)=>E.id===Z);P(at??null)}else P(null)},[F])),Gr=g((Z)=>{P(Z),y(!1),J(Z.id)},[J]),_r=g((Z)=>{v(Z),w(!1)},[v]);return L(()=>{if(!jt())history.replaceState({roomId:null},"",location.pathname)},[]),n(q,{children:[n(Qt,{rooms:F,currentRoomId:s?.id??null,userName:i,isOpen:c,onSelectRoom:Gr,onNameChange:a,onSettingsClick:()=>w(!0),onClose:()=>y(!1)},void 0,!1,void 0,this),c&&n(Wt,{onClick:()=>y(!1)},void 0,!1,void 0,this),n(Nt,{currentRoom:s,apiKey:t,userName:i,showInvite:!_,showTeamToggle:!!H,onMobileToggle:()=>y((Z)=>!Z),onTeamToggle:()=>A((Z)=>!Z),onInviteClick:()=>B(!0),onTeamInfo:m},void 0,!1,void 0,this),H&&n(Et,{teamInfo:H,isOpen:l,onClose:()=>A(!1)},void 0,!1,void 0,this),l&&n("div",{class:"team-sidebar-backdrop",onClick:()=>A(!1),style:"display:block"},void 0,!1,void 0,this),o&&n(Dt,{currentSchema:r,onSave:_r,onClose:()=>w(!1)},void 0,!1,void 0,this),T&&n(Vt,{onClose:()=>B(!1),onToast:(Z)=>{$(Z),B(!1)}},void 0,!1,void 0,this),G&&n(xt,{text:G,onDone:()=>$(null)},void 0,!1,void 0,this)]},void 0,!0,void 0,this)}function Gi(t,i){let[r,a]=f(()=>{return localStorage.getItem(t)??i}),v=g((F)=>{a(F),localStorage.setItem(t,F)},[t]);return[r,v]}var Tr=["curious","bold","swift","quiet","bright","keen","calm","wild","lazy","witty","brave","sly","warm","cool","zen"],Lr=["panda","fox","otter","hawk","wolf","owl","lynx","bear","deer","raven","hare","seal","wren","crane","moth"];function _0(){let t=Tr[Math.floor(Math.random()*Tr.length)],i=Lr[Math.floor(Math.random()*Lr.length)],r=Math.floor(Math.random()*100);return`${t}-${i}-${r}`}function Hr(){let t=localStorage.getItem(U.handle);if(!t)t=_0(),localStorage.setItem(U.handle,t);return t}function et(){let[t,i]=f(()=>$i()),[r,a]=Gi(U.handle,Hr()),[v,F]=Gi(U.colorSchema,tt),u=new URLSearchParams(location.search).get("token");L(()=>{O(v)},[v]);let s=g((c)=>{rr(c),i(c),history.replaceState(null,"","/chat"),location.reload()},[]),P=g((c)=>{F(c),O(c)},[]);if(u&&t)history.replaceState(null,"",location.pathname);if(u&&!t)return n(_t,{token:u,onLogin:s},void 0,!1,void 0,this);if(!t)return n(Gt,{onLogin:s},void 0,!1,void 0,this);return n(dt,{apiKey:t,userName:r,colorSchema:v,onNameChange:a,onSchemaChange:P},void 0,!1,void 0,this)}var zr=document.getElementById("root");if(zr)oi(n(et,{},void 0,!1,void 0,this),zr);
